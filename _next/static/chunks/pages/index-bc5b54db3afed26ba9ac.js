(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8962:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return U}});var n=r(5893),o=r(7294),i=r(9008),a=r(6158),s=r.n(a),l=r(6486),c=r(809),u=r.n(c),d=r(4047),f=r(2700),h=r(6265),p=r(2447);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,i=e})),f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g="mapbox://styles/mikelmaron/ckpxhtbgo1bcc17o643bds946";function x(e){var t=e.field,r=e.minramp,n=e.maxramp,o=e.high,i="232, 88%, 100%",a="0, 98%, 56%";return{"fill-color":["interpolate",["linear"],["zoom"],o?9:0,["interpolate",["linear"],["get",t],r,"hsla(".concat(i,", 0)"),n,"hsla(".concat(a,", 0)")],o?11:9,["interpolate",["linear"],["get",t],r,"hsla(".concat(i,", 0.5)"),n,"hsla(".concat(a,", 0.5)")],o?22:11,["interpolate",["linear"],["get",t],r,"hsla(".concat(i,", 0.5)"),n,"hsla(".concat(a,", 0.5)")]]}}var j=[{id:"pm2.5-high",source:"mapbox://mikelmaron.7euwrrvj","source-layer":"cali-projected-6z3k79",type:"fill",field:"D_PM25_2",label:"PM<sub>2.5</sub> index",paint:x({field:"D_PM25_2",minramp:-3228,maxramp:12512,high:!0})},{id:"pm2.5-low",source:"mapbox://mikelmaron.baqnetv7","source-layer":"EJSCREEN_2020_CA_D_PM25_2_dissolve",type:"fill",field:"D_PM25_2",label:"PM<sub>2.5</sub> index",paint:x({field:"D_PM25_2",minramp:-3228,maxramp:12512,high:!1})},{id:"resp-high",source:"mapbox://mikelmaron.1lin9onj","source-layer":"D_RESP_2geojson",type:"fill",field:"D_RESP_2",label:"Respiratory Hazard index",paint:x({field:"D_RESP_2",minramp:-1036,maxramp:3152,high:!0})},{id:"resp-low",source:"mapbox://mikelmaron.0xhwv3w2","source-layer":"D_RESP_2_bucketgeojson",type:"fill",field:"D_RESP_2",label:"Respiratory Hazard index",paint:x({field:"D_RESP_2",minramp:-1036,maxramp:3152,high:!1})}],w="pk.eyJ1IjoibWlrZWxtYXJvbiIsImEiOiJjaWZlY25lZGQ2cTJjc2trbmdiZDdjYjllIn0.Wx1n0X7aeCQyDTnK6_mrGw";function k(e){return P.apply(this,arguments)}function P(){return(P=(0,p.Z)(u().mark((function e(t){var r,n,o,i,a,s,l,c,d,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.replace("mapbox://styles/","https://api.mapbox.com/styles/v1/")+"?optimize=true&access_token="+w,e.next=3,fetch(r);case 3:return e.next=5,e.sent.json();case 5:n=e.sent,o=b(j);try{for(o.s();!(i=o.n()).done;)a=i.value,s=a.source,n.sources[s]=v({type:"vector",url:s},a.id.endsWith("high")?{minzoom:9,maxzoom:22}:{minzoom:0,maxzoom:11})}catch(u){o.e(u)}finally{o.f()}l=n.layers.findIndex((function(e){return"block-highlights"===e.id})),c=b(j);try{for(c.s();!(d=c.n()).done;)(f=d.value).layout={visibility:f.id.startsWith("pm")?"visible":"none"},n.layers.splice(l,0,f)}catch(u){c.e(u)}finally{c.f()}return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(){function e(t,r){var n=this;(0,d.Z)(this,e),(0,h.Z)(this,"map",void 0),(0,h.Z)(this,"featuresSource",void 0),(0,h.Z)(this,"handlers",void 0),(0,h.Z)(this,"lastSelection",void 0),(0,h.Z)(this,"lastGeoJSON",void 0),(0,h.Z)(this,"lastStyle",void 0),(0,h.Z)(this,"onClick",(function(e){n.handlers.current.onClick(e)})),(0,h.Z)(this,"onMouseMove",(function(e){n.handlers.current.onMouseMove(e)})),(0,h.Z)(this,"onMouseLeave",(function(e){n.handlers.current.onMouseLeave(e)})),(0,h.Z)(this,"onMoveEnd",(function(e){n.handlers.current.onMoveEnd(e)})),s().accessToken=w;var o=new(s().Map)(t);o.getCanvas().style.cursor="default",o.on("click",this.onClick);var i,a=b(j);try{for(a.s();!(i=a.n()).done;){var l=i.value;o.on("mousemove",l.id,this.onMouseMove),o.on("mouseleave",l.id,this.onMouseLeave)}}catch(c){a.e(c)}finally{a.f()}o.on("moveend",this.onMoveEnd),o.addControl(new(s().NavigationControl)({showCompass:!1})),this.setStyle(g).then((function(){})),this.map=o,this.handlers=r}return(0,f.Z)(e,[{key:"setData",value:function(){var e=(0,p.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.lastGeoJSON){e.next=2;break}return e.abrupt("return");case 2:if(this.featuresSource){e.next=4;break}return e.abrupt("return");case 4:this.featuresSource.setData(t),this.lastGeoJSON=t;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setStyle",value:function(){var e=(0,p.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.lastStyle){e.next=2;break}return e.abrupt("return");case 2:return this.lastStyle=t,e.next=5,k(t);case 5:return r=e.sent,this.map.setStyle(r,{diff:!1}),e.next=9,this.map.once("style.load");case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){this.map.remove()}}]),e}(),S=r(4155);function _(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){var r=e.setViewportData,i=e.filter,a=e.layer,c=(0,o.useRef)(null),u=(0,o.useRef)(null),d=(0,o.useRef)(null);function f(e){u.current.map.fitBounds(e,{padding:200,animate:!1})}function h(e){u.current.map.setCenter(e),u.current.map.zoomTo(15)}(0,o.useImperativeHandle)(t,(function(){return{setCenter:h,fitBounds:f}}));var p=(0,o.useRef)();return p.current={onClick:function(e){e.originalEvent.stopPropagation()},onMouseMove:function(e){var t=e.target;if(0!=e.features.length){var r,n,o=e.features[0],i=j.filter((function(e){return e.id==o.layer.id}))[0];if(void 0!==o.properties[i.field]){t.getCanvas().style.cursor="pointer",c.current||(c.current=new(s().Popup)({closeOnClick:!1,closeButton:!1,offset:[0,-2]}));var a=(r=o.properties[i.field],n=i.label,"<div class='flex flex-col items-center w-32'>\n    <div class=\"text-2xl font-bold text-gray-800\">".concat(Math.floor(r).toLocaleString(),'</div>\n    <div class="text-purple-400 text-md font-bold pt-1">').concat(n,"</div>\n  </div>"));c.current.setLngLat(e.lngLat).setHTML(a).addTo(t)}else t.getCanvas().style.cursor="default",c.current&&c.current.remove()}},onMouseLeave:function(e){e.target.getCanvas().style.cursor="default",c.current&&c.current.remove()},onMoveEnd:function(e){var t=e.target;if(t.getZoom()<9)return r(null),void t.setFilter("block-highlights",null);t.on("idle",(function(){return function(e){if(!(e.getZoom()<9)){var t,n=e.queryRenderedFeatures(void 0,{layers:["tabblock2010-06-pophu-blockgr-biqw81"]}),o=new Map,i=_(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;"POP10"in a.properties&&o.set(a.id,a.properties.POP10)}}catch(d){i.e(d)}finally{i.f()}var s=(0,l.sum)(Array.from(o.values())),c=j.filter((function(t){return t.id.endsWith("-high")&&"visible"==e.getLayoutProperty(t.id,"visibility")}))[0],u=e.queryRenderedFeatures(void 0,{layers:[c.id]}).map((function(e){return e.properties[c.field]})).filter((function(e){return void 0!==e})).sort((function(e,t){return e-t}));r({totalPopulation:s,numberOfBlockgroups:o.size,indicator:u})}}(t)}))}},(0,o.useEffect)((function(){if(!u.current)return u.current=new O({container:d.current,style:g,boxZoom:!1,bounds:[-127.17773437499999,31.052933985705163,-111.62109375,43.13306116240612],maxPitch:0,minZoom:4,maxZoom:17,dragRotate:!1},p),function(){u.current.remove(),u.current=null}}),[u,d]),(0,o.useEffect)((function(){try{var e=j.filter((function(e){return e.id.endsWith("-high")&&"visible"==u.current.map.getLayoutProperty(e.id,"visibility")}))[0];u.current.map.setFilter("block-highlights",["all",[">=",["to-number",["get",e.field]],i[0]],["<=",["to-number",["get",e.field]],i[1]]])}catch(t){}}),[u,i,a]),(0,o.useEffect)((function(){try{var e,t=_(j);try{for(t.s();!(e=t.n()).done;){var r=e.value;u.current.map.setLayoutProperty(r.id,"visibility",r.id.startsWith(a)?"visible":"none")}}catch(n){t.e(n)}finally{t.f()}}catch(o){}}),[u,a]),(0,n.jsx)("div",{ref:d,className:"flex-auto bg-gray-200"})}s().accessToken=S.env.NEXT_PUBLIC_MAPBOX_TOKEN;var M=(0,o.forwardRef)(E),C=r(4269),R=r(6320),D=r(5708),Z=r(9317),L=r(9641),A=r(2285),T=r(8548),z=r(8500);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e){var t=e.state,r=e.trackRef,i=e.index,a=e.height,s=e.marginTop,l=(0,o.useRef)(null),c=(0,Z.p)({index:i,trackRef:r,inputRef:l},t),u=c.thumbProps,d=c.inputProps,f=(0,L.Fx)(),h=f.focusProps,p=f.isFocusVisible;return(0,n.jsx)("div",{style:{position:"absolute",cursor:"pointer",transform:"translate(-50%, ".concat(s+a/4,"px)"),left:"".concat(100*t.getThumbPercent(i),"%")},children:(0,n.jsx)("div",B(B({},u),{},{style:{width:5,height:a/2,borderRadius:2,backgroundColor:p?"orange":t.isThumbDragging(i)?"#000":"#555"},children:(0,n.jsx)(A.T,{children:(0,n.jsx)("input",B({ref:l},(0,T.dG)(d,h)))})}))})}function W(e){var t=e.data,r=e.width,i=e.setFilter,a=(0,o.useRef)(null),s=100,l=10,c=10,u=20,d=10,f=(0,o.useMemo)((function(){return C.Ly_().thresholds(30)(t)}),[t]),h=C.Wem(t),p=C.BYU().domain(h).range([c,r-d]).nice(),m=C.BYU().domain([0,C.Fp7(f,(function(e){return e.length}))]).nice().range([s-u,l]),v=(0,z.Ux)(),b=(0,D.x)({numberFormatter:v,maxValue:h[1],minValue:h[0],defaultValue:h,step:1,onChange:function(e){i(e)}}),y=(0,Z.o)({"aria-label":"Range"},b,a).trackProps;return(0,n.jsxs)("div",{style:{width:"".concat(r,"px"),height:"".concat(s,"px")},className:"relative",children:[(0,n.jsxs)("svg",{className:"absolute top-0 left-0",width:r,height:s,viewBox:"0 0 ".concat(r," ").concat(s),children:[f.map((function(e,t){return(0,n.jsx)("rect",{fill:"#B91C1C",x:p(e.x0)+1,width:Math.max(0,p(e.x1)-p(e.x0)-1),y:m(e.length),height:m(0)-m(e.length)},t)})),(0,n.jsx)("g",{transform:"translate(0, ".concat(s-u,")"),children:(0,n.jsx)(R.R,{orient:R.K.bottom,scale:p,ticks:[null,"s"],tickSizeInner:2,domainPathProps:{stroke:"#ccc"},tickLineProps:{stroke:"#ccc"}})})]}),(0,n.jsx)("div",{style:{paddingLeft:"".concat(c,"px"),paddingRight:"".concat(d,"px")},children:(0,n.jsxs)("div",B(B({},y),{},{ref:a,style:{position:"relative",background:"transparent",height:s,width:" 100%"},children:[(0,n.jsx)("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.1)",right:"".concat(100*(1-b.getThumbPercent(0)),"%"),left:0,top:l,bottom:u}}),(0,n.jsx)("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.1)",left:"".concat(100*b.getThumbPercent(1),"%"),right:0,top:l,bottom:u}}),(0,n.jsx)(F,{index:0,state:b,trackRef:a,marginTop:l,height:s-u-l}),(0,n.jsx)(F,{index:1,state:b,trackRef:a,marginTop:l,height:s-u-l})]}))})]})}var J=[{short:"PM2.5",long:(0,n.jsxs)(n.Fragment,{children:["PM",(0,n.jsx)("sub",{children:"2.5"})," describes fine inhalable particles, with diameters that are generally 2.5 micrometers and smaller. Under the Clean Air Act, EPA sets and reviews national air quality standards for PM. /"," ",(0,n.jsxs)("a",{className:"text-blue-500 underline",href:"https://www.epa.gov/air-trends/particulate-matter-pm25-trends",children:[" ","Source: EPA.gov"]})]}),color:"text-blue-600",layer:"pm2.5"},{short:"Respiratory hazard",long:"Air toxics respiratory hazard index",color:"text-purple-600",layer:"resp"}];function U(){var e=(0,o.useState)(null),t=e[0],r=e[1],a=(0,o.useState)([-1500,1500]),s=a[0],l=a[1],c=(0,o.useState)(!1),u=c[0],d=c[1],f=(0,o.useState)(J[0]),h=f[0],p=f[1];return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-200 flex items-stretch",children:[(0,n.jsxs)(i.default,{children:[(0,n.jsx)("title",{children:"EJScreen"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)("div",{className:"flex-col w-64 bg-white shadow-lg md:w-96 ring-1 ring-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 font-bold bg-gray-100 text-md",children:[(0,n.jsx)("div",{className:"font-bold text-md",children:"EJSCREEN"}),(0,n.jsx)("div",{className:"text-sm font-thin",children:"Climate Justice"})]}),(0,n.jsx)("div",{className:"flex-auto overflow-y-auto",children:(0,n.jsxs)("div",{className:"px-5 pt-5",children:[(0,n.jsxs)("button",{onClick:function(){return d((function(e){return!e}))},className:"border border-gray-400 rounded-md px-2 py-0.5 flex items-center",children:["Indicators",(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-3 h-3 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u?(0,n.jsx)("div",{className:"pt-3",children:J.map((function(e){return(0,n.jsx)("button",{onClick:function(){p(e),d(!1)},className:"text-lg py-1 font-bold block ".concat(e.color),children:e.short},e.short)}))}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex pt-3 items-center "+h.color,children:[(0,n.jsx)("div",{className:"text-4xl font-bold",children:h.short}),(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})]}),(0,n.jsx)("div",{className:"pt-3 text-md",children:h.long}),t?(0,n.jsxs)("div",{className:"pt-4",children:[(0,n.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:t.totalPopulation.toLocaleString()}),(0,n.jsx)("div",{className:"text-sm",children:"Population"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:t.numberOfBlockgroups.toLocaleString()}),(0,n.jsx)("div",{className:"text-sm",children:"Blockgroups"})]})]})}),(0,n.jsxs)("div",{className:"pt-8",children:[(0,n.jsx)("div",{className:"pt-4 pb-4 text-sm font-bold border-t border-gray-200",children:h.long}),(0,n.jsx)(W,{data:t.indicator,width:300,setFilter:l})]})]}):null]})]})})]}),(0,n.jsx)(M,{filter:s,setViewportData:r,layer:h.layer})]})}},5301:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8962)}])}},function(e){e.O(0,[774,634,662,351,574],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);