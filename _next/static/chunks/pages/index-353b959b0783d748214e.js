(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8962:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(5893),o=r(7294),s=r(9008),i=r(6158),a=r.n(i),l=r(6486),c=r(809),u=r.n(c),d=r(4047),f=r(2700),h=r(6265),p=r(2447),m="ejscreen-2020-ca-d-pm25-2-dissolve copy",v="cali-projected-6z3k79 copy",x="pk.eyJ1IjoibWlrZWxtYXJvbiIsImEiOiJjaWZlY25lZGQ2cTJjc2trbmdiZDdjYjllIn0.Wx1n0X7aeCQyDTnK6_mrGw";function g(e){return b.apply(this,arguments)}function b(){return(b=(0,p.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.replace("mapbox://styles/","https://api.mapbox.com/styles/v1/")+"?optimize=true&access_token="+x,e.next=3,fetch(r);case 3:return e.next=5,e.sent.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=function(){function e(t,r){var n=this;(0,d.Z)(this,e),(0,h.Z)(this,"map",void 0),(0,h.Z)(this,"featuresSource",void 0),(0,h.Z)(this,"handlers",void 0),(0,h.Z)(this,"lastSelection",void 0),(0,h.Z)(this,"lastGeoJSON",void 0),(0,h.Z)(this,"lastStyle",void 0),(0,h.Z)(this,"onClick",(function(e){n.handlers.current.onClick(e)})),(0,h.Z)(this,"onMouseMove",(function(e){n.handlers.current.onMouseMove(e)})),(0,h.Z)(this,"onMouseLeave",(function(e){n.handlers.current.onMouseLeave(e)})),(0,h.Z)(this,"onMoveEnd",(function(e){n.handlers.current.onMoveEnd(e)})),a().accessToken=x;var o=new(a().Map)(t);o.getCanvas().style.cursor="default",o.on("click",this.onClick),o.on("mousemove",m,this.onMouseMove),o.on("mouseleave",m,this.onMouseLeave),o.on("mousemove",v,this.onMouseMove),o.on("mouseleave",v,this.onMouseLeave),o.on("moveend",this.onMoveEnd),o.addControl(new(a().NavigationControl)({showCompass:!1})),this.setStyle("mapbox://styles/mikelmaron/ckmxwzmzq19pp17pr9j778ik8").then((function(){})),this.map=o,this.handlers=r}return(0,f.Z)(e,[{key:"setData",value:function(){var e=(0,p.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.lastGeoJSON){e.next=2;break}return e.abrupt("return");case 2:if(this.featuresSource){e.next=4;break}return e.abrupt("return");case 4:this.featuresSource.setData(t),this.lastGeoJSON=t;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setStyle",value:function(){var e=(0,p.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.lastStyle){e.next=2;break}return e.abrupt("return");case 2:return this.lastStyle=t,e.next=5,g(t);case 5:return r=e.sent,this.map.setStyle(r,{diff:!1}),e.next=9,this.map.once("style.load");case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){this.map.remove()}}]),e}(),j=r(4155);function w(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw s}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(e,t){var r=e.setViewportData,s=e.filter,i=(0,o.useRef)(null),c=(0,o.useRef)(null),u=(0,o.useRef)(null);function d(e){c.current.map.fitBounds(e,{padding:200,animate:!1})}function f(e){c.current.map.setCenter(e),c.current.map.zoomTo(15)}(0,o.useImperativeHandle)(t,(function(){return{setCenter:f,fitBounds:d}}));var h=(0,o.useRef)();return h.current={onClick:function(e){e.originalEvent.stopPropagation()},onMouseMove:function(e){var t=e.target;if(0!=e.features.length){var r=e.features[0];if(void 0!==r.properties.D_PM25_2){t.getCanvas().style.cursor="pointer",i.current||(i.current=new(a().Popup)({closeOnClick:!1,closeButton:!1,offset:[0,-2]}));var n=function(e){var t=e.properties;return"<div class='flex flex-col items-center w-32'>\n    <div class=\"text-2xl font-bold text-gray-800\">".concat(Math.floor(t.D_PM25_2).toLocaleString(),'</div>\n    <div class="text-purple-400 text-md font-bold pt-1">PM<sub>2.5</sub> index</div>\n  </div>')}(r);i.current.setLngLat(e.lngLat).setHTML(n).addTo(t)}else t.getCanvas().style.cursor="default",i.current&&i.current.remove()}},onMouseLeave:function(e){e.target.getCanvas().style.cursor="default",i.current&&i.current.remove()},onMoveEnd:function(e){var t=e.target;if(t.getZoom()<9)return r(null),void t.setFilter("block-highlights",null);t.on("idle",(function(){return function(e){if(!(e.getZoom()<9)){var t,n=e.queryRenderedFeatures(void 0,{layers:["tabblock2010-06-pophu-blockgr-biqw81"]}),o=new Map,s=w(n);try{for(s.s();!(t=s.n()).done;){var i=t.value;"POP10"in i.properties&&o.set(i.id,i.properties.POP10)}}catch(u){s.e(u)}finally{s.f()}var a=(0,l.sum)(Array.from(o.values())),c=e.queryRenderedFeatures(void 0,{layers:[v]}).map((function(e){return e.properties.D_PM25_2})).filter((function(e){return void 0!==e})).sort((function(e,t){return e-t}));r({totalPopulation:a,numberOfBlockgroups:o.size,pm25:c})}}(t)}))}},(0,o.useEffect)((function(){if(!c.current)return c.current=new y({container:u.current,style:"mapbox://styles/mikelmaron/ckmxwzmzq19pp17pr9j778ik8",boxZoom:!1,bounds:[-127.17773437499999,31.052933985705163,-111.62109375,43.13306116240612],maxPitch:0,minZoom:4,maxZoom:17,dragRotate:!1},h),function(){c.current.remove(),c.current=null}}),[c,u]),(0,o.useEffect)((function(){try{c.current.map.setFilter("block-highlights",["all",[">=",["to-number",["get","D_PM25_2"]],s[0]],["<=",["to-number",["get","D_PM25_2"]],s[1]]])}catch(e){}}),[c,s]),(0,n.jsx)("div",{ref:u,className:"flex-auto bg-gray-200"})}a().accessToken=j.env.NEXT_PUBLIC_MAPBOX_TOKEN;var M=(0,o.forwardRef)(P),N=r(4269),S=r(6320),O=r(5708),C=r(9317),T=r(9641),_=r(2285),Z=r(8548),L=r(8500);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,h.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=e.state,r=e.trackRef,s=e.index,i=e.height,a=e.marginTop,l=(0,o.useRef)(null),c=(0,C.p)({index:s,trackRef:r,inputRef:l},t),u=c.thumbProps,d=c.inputProps,f=(0,T.Fx)(),h=f.focusProps,p=f.isFocusVisible;return(0,n.jsx)("div",{style:{position:"absolute",cursor:"pointer",transform:"translate(-50%, ".concat(a+i/4,"px)"),left:"".concat(100*t.getThumbPercent(s),"%")},children:(0,n.jsx)("div",E(E({},u),{},{style:{width:5,height:i/2,borderRadius:2,backgroundColor:p?"orange":t.isThumbDragging(s)?"#000":"#555"},children:(0,n.jsx)(_.T,{children:(0,n.jsx)("input",E({ref:l},(0,Z.dG)(d,h)))})}))})}function A(e){var t=e.data,r=e.width,s=e.setFilter,i=(0,o.useRef)(null),a=100,l=10,c=10,u=20,d=10,f=(0,o.useMemo)((function(){return N.Ly_().thresholds(30)(t)}),[t]),h=[-2e4,65e3],p=N.BYU().domain(h).range([c,r-d]).nice(),m=N.BYU().domain([0,N.Fp7(f,(function(e){return e.length}))]).nice().range([a-u,l]),v=(0,L.Ux)(),x=(0,O.x)({numberFormatter:v,maxValue:h[1],minValue:h[0],defaultValue:h,step:1,onChange:function(e){s(e)}}),g=(0,C.o)({"aria-label":"Range"},x,i),b=(g.groupProps,g.trackProps),y=g.labelProps,j=g.outputProps;return(0,n.jsxs)("div",{style:{width:"".concat(r,"px"),height:"".concat(a,"px")},className:"relative",children:[(0,n.jsxs)("svg",{className:"absolute top-0 left-0",width:r,height:a,viewBox:"0 0 ".concat(r," ").concat(a),children:[f.map((function(e,t){return(0,n.jsx)("rect",{fill:"#B91C1C",x:p(e.x0)+1,width:Math.max(0,p(e.x1)-p(e.x0)-1),y:m(e.length),height:m(0)-m(e.length)},t)})),(0,n.jsx)("g",{transform:"translate(0, ".concat(a-u,")"),children:(0,n.jsx)(S.R,{orient:S.K.bottom,scale:p,ticks:[null,"s"],tickSizeInner:2,domainPathProps:{stroke:"#ccc"},tickLineProps:{stroke:"#ccc"}})})]}),(0,n.jsx)("div",{style:{paddingLeft:"".concat(c,"px"),paddingRight:"".concat(d,"px")},children:(0,n.jsxs)("div",E(E({},b),{},{ref:i,style:{position:"relative",background:"transparent",height:a,width:" 100%"},children:[(0,n.jsx)("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.1)",right:"".concat(100*(1-x.getThumbPercent(0)),"%"),left:0,top:l,bottom:u}}),(0,n.jsx)("div",{style:{position:"absolute",background:"rgba(0, 0, 0, 0.1)",left:"".concat(100*x.getThumbPercent(1),"%"),right:0,top:l,bottom:u}}),(0,n.jsx)(D,{index:0,state:x,trackRef:i,marginTop:l,height:a-u-l}),(0,n.jsx)(D,{index:1,state:x,trackRef:i,marginTop:l,height:a-u-l})]}))}),(0,n.jsx)(_.T,{children:(0,n.jsxs)("div",{style:{display:"flex",alignSelf:"stretch"},children:[(0,n.jsx)("label",E(E({},y),{},{children:"Range"})),(0,n.jsx)("output",E(E({},j),{},{style:{flex:"1 0 auto",textAlign:"end"},children:"".concat(x.getThumbValueLabel(0)," - ").concat(x.getThumbValueLabel(1))}))]})})]})}var z=r(9701),B=[{short:"Pre-1960s Housing",long:"% pre-1960 housing (lead paint indicator)",color:"yellow"},{short:"Diesel particulate matter",long:"Diesel particulate matter level in air",color:"red"},{short:"Air toxics cancer risk",long:"Air toxics cancer risk",color:"purple"},{short:"Respiratory hazard",long:"Air toxics respiratory hazard index",color:"purple"},{short:"Traffic",long:"Traffic proximity and volume",color:"blue"},{short:"Water pollution",long:"Indicator for major direct dischargers to water",color:"blue"},{short:"National Priorities List",long:"Proximity to National Priorities List (NPL) sites",color:"yellow"},{short:"Risk Management Plan",long:"Proximity to Risk Management Plan (RMP) facilities",color:"yellow"},{short:"Treatment Storage and Disposal",long:"Proximity to Treatment Storage and Disposal (TSDF) facilities",color:"pink"},{short:"Ozone",long:"Ozone level in air",color:"blue"},{short:"PM2.5",long:"PM2.5 level in air",color:"blue"}];function F(e){var t=e.onClose;return(0,n.jsx)("div",{className:"pt-3",children:B.map((function(e){return(0,n.jsx)("button",{onClick:function(){return t()},className:"text-lg py-1 font-bold block text-".concat(e.color,"-600"),children:e.short},e.short)}))})}function I(){var e=(0,o.useState)(null),t=e[0],r=e[1],i=(0,o.useState)([-1500,1500]),a=i[0],l=i[1],c=(0,o.useState)(!1),u=c[0],d=c[1],f=(0,z.ZP)(),h=f.observe,p=f.width;return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-200 flex items-stretch",children:[(0,n.jsxs)(s.default,{children:[(0,n.jsx)("title",{children:"EJScreen"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)("div",{className:"bg-white w-64 md:w-96 ring-1 ring-gray-200 shadow-lg flex-col",children:[(0,n.jsxs)("div",{className:"p-4 text-md font-bold bg-gray-100 flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-md font-bold",children:"EJSCREEN"}),(0,n.jsx)("div",{className:"text-sm font-thin",children:"Climate Justice"})]}),(0,n.jsx)("div",{className:"flex-auto overflow-y-auto",children:(0,n.jsxs)("div",{className:"pt-5 px-5",children:[(0,n.jsxs)("button",{onClick:function(){return d((function(e){return!e}))},className:"border border-gray-400 rounded-md px-2 py-0.5 flex items-center",children:["Indicators",(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"ml-2 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u?(0,n.jsx)(F,{onClose:function(){return d(!1)}}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex pt-3 items-center text-purple-600",children:[(0,n.jsx)("div",{className:"font-bold text-4xl",children:"PM2.5"}),(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"ml-2 h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})]}),(0,n.jsxs)("div",{className:"pt-3 text-md",children:["PM",(0,n.jsx)("sub",{children:"2.5"})," describes fine inhalable particles, with diameters that are generally 2.5 micrometers and smaller. Under the Clean Air Act, EPA sets and reviews national air quality standards for PM."," / ",(0,n.jsx)("a",{className:"underline text-blue-500",href:"https://www.epa.gov/air-trends/particulate-matter-pm25-trends",children:"Source: EPA.gov"})]}),t?(0,n.jsxs)("div",{className:"pt-4",children:[(0,n.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-bold text-2xl",children:t.totalPopulation.toLocaleString()}),(0,n.jsx)("div",{className:"text-sm",children:"Population"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-bold text-2xl",children:t.numberOfBlockgroups.toLocaleString()}),(0,n.jsx)("div",{className:"text-sm",children:"Blockgroups"})]})]})}),(0,n.jsxs)("div",{className:"pt-8",children:[(0,n.jsx)("div",{ref:h}),(0,n.jsx)("div",{className:"pt-4 pb-4 border-t border-gray-200 text-sm font-bold",children:"PM2.5 indexes"}),(0,n.jsx)(A,{data:t.pm25,width:p,setFilter:l})]})]}):null]})]})})]}),(0,n.jsx)(M,{filter:a,setViewportData:r})]})}},5301:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8962)}])}},function(e){e.O(0,[774,634,662,351,212],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);